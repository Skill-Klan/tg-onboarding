#!/bin/bash

echo "üöÄ –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è FAQ –¥–æ–¥–∞—Ç–∫—É..."
echo "================================================"

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∑–∞–ø—É—â–µ–Ω–∏–π —Å–µ—Ä–≤–µ—Ä
if ! netstat -tlnp | grep -q ":8081"; then
    echo "üåê –ó–∞–ø—É—Å–∫ HTTP —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ø–æ—Ä—Ç—É 8081..."
    python3 -m http.server 8081 &
    SERVER_PID=$!
    echo "‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω–æ –∑ PID: $SERVER_PID"
    sleep 2
else
    echo "‚úÖ HTTP —Å–µ—Ä–≤–µ—Ä –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∏–π –Ω–∞ –ø–æ—Ä—Ç—É 8081"
fi

# –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ç–µ—Å—Ç–∏
echo ""
echo "üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤..."
node run-tests.js

echo ""
echo "üåê –í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä —Ç–∞ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞:"
echo "   üì± –û—Å–Ω–æ–≤–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫: http://localhost:8081"
echo "   üß™ –°—Ç–æ—Ä—ñ–Ω–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è: http://localhost:8081/test-search.html"
echo ""
echo "üìã –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó:"
echo "   1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ test-search.html"
echo "   2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è"
echo "   3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞"
echo ""
echo "üõë –î–ª—è –∑—É–ø–∏–Ω–∫–∏ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Ctrl+C"

# –ß–µ–∫–∞—î–º–æ —Å–∏–≥–Ω–∞–ª –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
trap 'echo ""; echo "üõë –ó—É–ø–∏–Ω–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞..."; kill $SERVER_PID 2>/dev/null; exit 0' INT

# –¢—Ä–∏–º–∞—î–º–æ —Å–∫—Ä–∏–ø—Ç –∞–∫—Ç–∏–≤–Ω–∏–º
while true; do
    sleep 1
done
