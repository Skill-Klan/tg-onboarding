# üöÄ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—é

## üîê –°–µ–∫—Ä–µ—Ç–∏ —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ –≤ GitHub

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ: **Repository ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions**

### –û–±–æ–≤'—è–∑–∫–æ–≤—ñ —Å–µ–∫—Ä–µ—Ç–∏:

| –ù–∞–∑–≤–∞ | –û–ø–∏—Å | –ü—Ä–∏–∫–ª–∞–¥ |
|-------|------|---------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | `1234567890:ABCdef...` |
| `HOST` | IP –∞–¥—Ä–µ—Å–∞ –∞–±–æ –¥–æ–º–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞ | `192.168.1.100` –∞–±–æ `yourdomain.com` |
| `USERNAME` | –Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ | `ubuntu` –∞–±–æ `root` |
| `SSH_PRIVATE_KEY` | –ü—Ä–∏–≤–∞—Ç–Ω–∏–π SSH –∫–ª—é—á | (–¥–∏–≤. —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é –Ω–∏–∂—á–µ) |

## üîë –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SSH –∫–ª—é—á—ñ–≤

### 1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è SSH –∫–ª—é—á—ñ–≤ (–Ω–∞ –≤–∞—à—ñ–π –º–∞—à–∏–Ω—ñ)
```bash
# –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π SSH –∫–ª—é—á –¥–ª—è –¥–µ–ø–ª–æ—é
ssh-keygen -t ed25519 -C "github-actions-deploy" -f ~/.ssh/github_deploy

# –ê–±–æ RSA —è–∫—â–æ ed25519 –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è
ssh-keygen -t rsa -b 4096 -C "github-actions-deploy" -f ~/.ssh/github_deploy
```

### 2. –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```bash
# –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh-copy-id -i ~/.ssh/github_deploy.pub username@your-server-ip

# –ê–±–æ –≤—Ä—É—á–Ω—É –¥–æ–¥–∞—Ç–∏ –¥–æ authorized_keys
cat ~/.ssh/github_deploy.pub | ssh username@your-server-ip "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys"
```

### 3. –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ GitHub Secrets
```bash
# –ü–æ–∫–∞–∑–∞—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è
cat ~/.ssh/github_deploy

# –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤–µ—Å—å –≤–º—ñ—Å—Ç (–≤–∫–ª—é—á–Ω–æ –∑ -----BEGIN —ñ -----END)
# —ñ –≤—Å—Ç–∞–≤–∏—Ç–∏ –≤ GitHub Secret SSH_PRIVATE_KEY
```

## üñ•Ô∏è –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### 1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –ø–∞–∫–µ—Ç—ñ–≤
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install -y nodejs npm git

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–µ—Ä—Å—ñ–π
node --version  # –ú–∞—î –±—É—Ç–∏ 18+
npm --version
git --version
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –¥–ª—è –¥–µ–ø–ª–æ—é
```bash
# –°—Ç–≤–æ—Ä–∏—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é (–∑–º—ñ–Ω—ñ—Ç—å —à–ª—è—Ö –≤ deploy.yml —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
sudo mkdir -p /home/ubuntu/apps/tg-onboarding
sudo chown $USER:$USER /home/ubuntu/apps/tg-onboarding
```

### 3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Git (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
```bash
git config --global user.name "Deploy Bot"
git config --global user.email "deploy@yourdomain.com"
```

## üîÑ –Ø–∫ –ø—Ä–∞—Ü—é—î –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π

### –¢—Ä–∏–≥–µ—Ä–∏:
- ‚úÖ Push –≤ –≥—ñ–ª–∫—É `main` –∞–±–æ `master`
- ‚úÖ –ó–ª–∏—Ç—Ç—è Pull Request –≤ main

### –ü—Ä–æ—Ü–µ—Å:
1. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è** - –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–æ–¥—É —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
2. **SSH –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è** - –±–µ–∑–ø–µ—á–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º
3. **–û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É** - git pull –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –∑–º—ñ–Ω
4. **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π** - npm ci
5. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞** - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è .env
6. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞** - –∑—É–ø–∏–Ω–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ, –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ
7. **Health check** - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —â–æ –±–æ—Ç –ø—Ä–∞—Ü—é—î

### –õ–æ–≥—É–≤–∞–Ω–Ω—è:
- –õ–æ–≥–∏ –¥–µ–ø–ª–æ—é: GitHub Actions
- –õ–æ–≥–∏ –±–æ—Ç–∞: `/home/ubuntu/apps/tg-onboarding/bot.log`

## üõ†Ô∏è –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞
ps aux | grep "node.*index.mjs"

# –ü–æ–¥–∏–≤–∏—Ç–∏—Å—å –ª–æ–≥–∏
tail -f /home/ubuntu/apps/tg-onboarding/bot.log

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –±–æ—Ç–∞ –≤—Ä—É—á–Ω—É
cd /home/ubuntu/apps/tg-onboarding/tg_bot
pkill -f "node.*index.mjs"
nohup npm start > ../bot.log 2>&1 &

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ—Ä—Ç–∏
netstat -tlnp | grep :3000
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö –≤ deploy.yml

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Ü—ñ –∑–º—ñ–Ω–Ω—ñ –≤ `.github/workflows/deploy.yml`:

```yaml
env:
  NODE_VERSION: '18'                                    # –í–µ—Ä—Å—ñ—è Node.js
  APP_NAME: 'tg-onboarding-bot'                        # –ù–∞–∑–≤–∞ –¥–æ–¥–∞—Ç–∫—É  
  DEPLOY_PATH: '/home/ubuntu/apps/tg-onboarding'       # –®–ª—è—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
```

## üö® Troubleshooting

### SSH –ø–æ–º–∏–ª–∫–∏:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ SSH –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
ssh -i ~/.ssh/github_deploy username@your-server-ip

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∞ –Ω–∞ –∫–ª—é—á—ñ
chmod 600 ~/.ssh/github_deploy
chmod 644 ~/.ssh/github_deploy.pub
```

### –ü—Ä–æ–±–ª–µ–º–∏ –∑ –±–æ—Ç–æ–º:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
tail -20 /home/ubuntu/apps/tg-onboarding/bot.log

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
cd /home/ubuntu/apps/tg-onboarding/tg_bot
cat .env
npm run validate
```

### –ü—Ä–æ–±–ª–µ–º–∏ –∑ –ø–æ—Ä—Ç–∞–º–∏:
```bash
# –ó–≤—ñ–ª—å–Ω–∏—Ç–∏ –ø–æ—Ä—Ç —è–∫—â–æ –∑–∞–π–Ω—è—Ç–∏–π
sudo lsof -i :3000
sudo kill -9 PID
```

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Å–µ–∫—Ä–µ—Ç—ñ–≤ —Ç–∞ SSH:
1. –ó—Ä–æ–±—ñ—Ç—å push –≤ main –≥—ñ–ª–∫—É
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ GitHub Actions
3. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–µ–ø–ª–æ—ó—Ç—å—Å—è –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä!

üéâ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –¥–µ–ø–ª–æ–π –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ!**
